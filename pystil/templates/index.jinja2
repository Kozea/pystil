{% extends "_layout.jinja2" %}

{% block article %}
  <nav class="links"><a href="{{ url_for('keys') }}">Manage secret keys</a></aside>
  <aside class="graph" data-graph="Last" data-criteria="all"></aside>
  <article class="sites">
    <table>
      <thead>
        <tr>
          <th>Visits</th>
          <th>Domain</th>
          <th>Stats</th>
        </tr>
      </thead>
      <tbody>
        <tr class="domain">
          <td>{{ all_ }}</td>
          <td>All</td>
          <td><a href="{{ url_for('site', site='all') }}">Go</a></td>
        </tr>
        {% for site in sites %}
          {% if site and site.domain %}
            <tr class="domain">
              <td>{{ site.count }}</td>
              <td>{{ site.domain }}</td>
              <td><a href="{{ url_for('site', site=site.domain) }}">Go</a></td>
            </tr>
            {% for subdomain, count in site.subdomains if subdomain %}
              <tr class="subdomain">
                <td>{{ count }}</td>
                <td>{{ subdomain }}</td>
                <td><a href="{{ url_for('site', site=subdomain+'.'+site.domain) }}">Go</a></td>
              </tr>
            {% endfor %}
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </article>
{% endblock article %}
